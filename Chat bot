import time
from telegram import Update
from telegram.ext import Updater, CommandHandler, MessageHandler, Filters, ConversationHandler, CallbackContext

# DicionÃ¡rio com respostas personalizadas
respostas = {
    'saudacao': "OlÃ¡! Sou Caio Martins e vou te mostrar como mudar sua vida financeira! Qual Ã© o seu nome? ğŸ˜",
    'prazer': "Prazer, {nome}! Agora, antes de te mostrar como ganhar dinheiro online, me diz: vocÃª jÃ¡ tentou ganhar dinheiro pela internet antes? ğŸ’»",
    'ajuda': "Estou aqui para ajudar vocÃª a alcanÃ§ar os resultados que deseja. Me conta um pouco mais sobre vocÃª, como estÃ¡ a sua jornada no mercado digital? ğŸš€",
    'dificuldade_inicio': "No comeÃ§o Ã© realmente difÃ­cil, mas depois que vocÃª aprende, Ã© sÃ³ lucro ğŸ¤‘ğŸ’µ",
    'desafios': "Quais desafios vocÃª tem enfrentado no mercado digital? Eu entendo como Ã© complicado no inÃ­cio! ğŸ˜•",
    'estrategias': "VocÃª jÃ¡ tentou alguma estratÃ©gia para alcanÃ§ar seus resultados, mas sentiu que nÃ£o estava funcionando? Eu passei por isso tambÃ©m, e posso te ajudar! ğŸ˜ƒ",
    'dificuldade': "Ã‰ assim mesmo, no comeÃ§o Ã© mais difÃ­cil ğŸ˜…",
    'tempo': "Quanto tempo jÃ¡ faz que vocÃª estÃ¡ tentando ganhar dinheiro online? â³",
    'veterano': "Legal! EntÃ£o vocÃª jÃ¡ Ã© um veterano do mercado digital ğŸ«¡",
    'dificuldade_jornada': "VocÃª jÃ¡ enfrentou muitas dificuldades durante sua jornada? ğŸ˜”",
    'erro_metodologia': "Eu tambÃ©m enfrentei dificuldades no comeÃ§o, sabia? Demorei muito atÃ© entender o que realmente dava resultado. Quando encontrei o caminho certo, minha renda cresceu! ğŸ’ª",
    'metodologia': "Eu passei 6 meses tentando fazer minha primeira venda no mercado digital. Sei bem como Ã© frustrante, mas depois que descobri a metodologia certa, tudo mudou! âš¡",
    'solucao': "Eu criei uma metodologia que pode ser a chave para o seu sucesso! VocÃª vai aprender a evitar os mesmos erros que cometi e acelerar sua jornada para o sucesso. ğŸš€",
    'aceleracao': "Com minha metodologia, vocÃª vai aprender tudo o que eu aprendi, mas de forma mais rÃ¡pida. Vamos acelerar seu processo e fazer vocÃª alcanÃ§ar suas primeiras vendas! â©",
    'next_step': "Eu quero que vocÃª tenha o sucesso que eu tive, e mais rÃ¡pido! A minha metodologia foi criada para te ajudar a alcanÃ§ar seus sonhos. Que tal dar o prÃ³ximo passo agora? ğŸ’¼",
    'comeÃ§ar_hoje': "Que tal comeÃ§ar hoje mesmo? ğŸ’µ",
    'confianÃ§a': "NÃ£o sou diferente de vocÃª. Passei por dificuldades, cometi erros, mas aprendi muito ao longo do caminho. Quero compartilhar isso com vocÃª para evitar que vocÃª passe pelos mesmos obstÃ¡culos. ğŸ‘Š",
    'instagram': "Para vocÃª saber mais sobre mim, esse Ã© o link do meu Instagram pessoal: https://www.instagram.com/caiomartins/profilecard/?igsh=bGcweWdhbDM3eXhi ğŸ“²",
    'conta_comercial': "Aqui estÃ¡ uma das minhas contas comerciais caso queira tirar alguma dÃºvida. ğŸ’¬",
    'confianÃ§a_final': "EntÃ£o, estÃ¡ mais confiante de que posso te ajudar a alcanÃ§ar seus objetivos? â˜ºï¸",
    'investimento': "SÃ³ mais uma pergunta: quanto vocÃª estÃ¡ disposto a investir no mercado digital? ğŸ’°",
    'investimento_certo': "Investir no que Ã© certo sempre Ã© a melhor escolha. ğŸ’¡",
    'metodologia_link': "Aqui estÃ¡ o link da minha metodologia ğŸ‘‰ğŸ‘‰ğŸ‘‰ https://pay.kiwify.com.br/XhmT4CD?afid=xvaO5Afr ğŸ”¥",
    'metodologia_exp': """Na minha metodologia, vocÃª vai encontrar:

    - Um GRUPO NO TELEGRAM com suporte para tirar suas dÃºvidas. ğŸ‘¥
    - Produtos como E-BOOKs para vocÃª vender no Kiwify de graÃ§a. ğŸ“š
    - Vou te ensinar a CONVERTER SEUS LEADS. ğŸ”„
    - Como ganhar dinheiro com TRÃFEGO ORGÃ‚NICO ğŸŒ±
    - E muito mais! EstÃ¡ esperando o que para ser o prÃ³ximo milionÃ¡rio? ğŸ¤‘ğŸ«µ""",
    'garantir_vaga': "EntÃ£o, vai lÃ¡ nesse link e garanta sua vaga: https://pay.kiwify.com.br/XhmT4CD?afid=xvaO5Afr. Lembrando que resta apenas 20 vagas e a promoÃ§Ã£o vai atÃ© meia-noite! ğŸ•›",
    'dicas_gratis': "Caso vocÃª queira receber dicas de graÃ§a e ficar por dentro do mercado digital, clique nesse link ğŸ‘‰ğŸ‘‰ https://dtc1rver.forms.app/formulario-de-captura-de-e-mail-e-contato ğŸ“§"
}

# FunÃ§Ãµes para o bot

def saudacao(update: Update, context: CallbackContext):
    update.message.reply_text(respostas['saudacao'])
    return 'nome'

def capturar_nome(update: Update, context: CallbackContext):
    nome = update.message.text.strip().capitalize()
    context.user_data['nome'] = nome
    update.message.reply_text(f"Prazer, {nome}! Agora, antes de te mostrar como ganhar dinheiro online, me diz: vocÃª jÃ¡ tentou ganhar dinheiro pela internet antes? ğŸ’»")
    return 'tentativa'

def tentativa(update: Update, context: CallbackContext):
    tentativa = update.message.text.lower()
    if tentativa == 'sim' or tentativa == 'nÃ£o':
        update.message.reply_text(respostas['ajuda'])
    else:
        update.message.reply_text("Desculpe, nÃ£o entendi. Vamos continuar com o nosso bate-papo! ğŸ˜Š")
    return 'jornada'

def coletar_jornada(update: Update, context: CallbackContext):
    nome = context.user_data['nome']
    update.message.reply_text(respostas['dificuldade_inicio'])
    return 'desafio'

def desafios(update: Update, context: CallbackContext):
    nome = context.user_data['nome']
    update.message.reply_text(f"Quais desafios vocÃª tem enfrentado no mercado digital, {nome}? Eu entendo bem como Ã© complicado no inÃ­cio! ğŸ˜•")
    return 'analise_dificuldade'

def analise_dificuldade(update: Update, context: CallbackContext):
    desafio = update.message.text.lower()
    nome = context.user_data['nome']
    if "difÃ­cil" in desafio:
        update.message.reply_text(f"Ã‰ difÃ­cil {nome}, mas com essa metodologia isso tudo pode mudar agora. ğŸ’ª")
    else:
        update.message.reply_text(f"VocÃª jÃ¡ tentou alguma estratÃ©gia para alcanÃ§ar seus resultados, mas sentiu que nÃ£o estava funcionando? Eu passei por isso tambÃ©m, e posso te ajudar! ğŸ˜ƒ")
    return 'tempo'

def tempo_de_mercado(update: Update, context: CallbackContext):
    update.message.reply_text(respostas['tempo'])
    return 'investimento'

def investimento(update: Update, context: CallbackContext):
    update.message.reply_text(respostas['investimento'])
    return 'final'

def finalizar(update: Update, context: CallbackContext):
    update.message.reply_text(respostas['metodologia_link'])
    return ConversationHandler.END

def main():
    token = '8033504974:AAHyO8T98NvQp0p5f51IkJxqDmEJMhvt4Xk'

    updater = Updater(token, use_context=True)
    dispatcher = updater.dispatcher

    conv_handler = ConversationHandler(
        entry_points=[CommandHandler('start', saudacao)],
        states={
            'nome': [MessageHandler(Filters.text & ~Filters.command, capturar_nome)],
            'tentativa': [MessageHandler(Filters.text & ~Filters.command, tentativa)],
            'jornada': [MessageHandler(Filters.text & ~Filters.command, coletar_jornada)],
            'desafio': [MessageHandler(Filters.text & ~Filters.command, desafios)],
            'analise_dificuldade': [MessageHandler(Filters.text & ~Filters.command, analise_dificuldade)],
            'tempo': [MessageHandler(Filters.text & ~Filters.command, tempo_de_mercado)],
            'investimento': [MessageHandler(Filters.text & ~Filters.command, investimento)],
            'final': [MessageHandler(Filters.text & ~Filters.command, finalizar)],
        },
        fallbacks=[],
    )

    dispatcher.add_handler(conv_handler)

    updater.start_polling()
    updater.idle()

if __name__ == '__main__':
    main()
